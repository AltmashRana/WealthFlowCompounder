<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="logo.png" type="image/png">
    <title>WealthFlow | Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --primary: #818cf8;
            --primary-glow: rgba(129, 140, 248, 0.2);
            --accent: #34d399;
            --bg: #0b0f1a;
            --card: #161b2c;
            --input-bg: #0f172a;
            --text-main: #f8fafc;
            --text-dim: #94a3b8;
            --border: #2d3748;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--bg);
            background-image: radial-gradient(circle at 0% 0%, #1e1b4b 0%, transparent 25%),
                radial-gradient(circle at 100% 100%, #1e1b4b 0%, transparent 25%);
            color: var(--text-main);
            min-height: 100vh;
            padding: 40px 20px;
        }

        .wrapper {
            max-width: 1250px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            align-items: stretch;
        }

        @media (max-width: 1100px) {
            .wrapper {
                grid-template-columns: 1fr;
            }
        }

        .panel {
            background: var(--card);
            border: 1px solid var(--border);
            padding: 32px;
            border-radius: 28px;
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
        }

        .header-flex {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            gap: 15px;
            flex-wrap: wrap;
        }

        .header-actions {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-grow: 1;
            justify-content: flex-end;
        }

        h1 {
            font-size: 1.4rem;
            font-weight: 800;
            letter-spacing: -0.02em;
            margin-bottom: 0;
        }

        .result-panel h1 {
            margin-bottom: 35px;
        }

        @media (max-width: 600px) {
            .header-actions {
                justify-content: space-between;
                width: 100%;
            }

            .btn-action:not(.btn-clear) {
                flex: 1;
                justify-content: center;
            }
        }

        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .field {
            display: flex;
            flex-direction: column;
        }

        label {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-dim);
            margin-bottom: 12px;
            font-weight: 700;
            height: 20px;
            display: flex;
            align-items: flex-end;
            white-space: nowrap;
        }

        input {
            background: var(--input-bg);
            border: 1px solid var(--border);
            padding: 14px;
            border-radius: 14px;
            color: white;
            font-size: 0.95rem;
            transition: all 0.2s ease;
            width: 100%;
        }

        input:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 4px var(--primary-glow);
        }

        .section-title {
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--text-dim);
            margin: 25px 0 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .invest-row {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 45px;
            gap: 12px;
            margin-bottom: 12px;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .btn-add {
            background: rgba(129, 140, 248, 0.1);
            color: var(--primary);
            border: 1px dashed var(--primary);
            padding: 8px 16px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 700;
            font-size: 0.8rem;
            transition: 0.2s;
        }

        .btn-add:hover {
            background: var(--primary);
            color: white;
            border-style: solid;
        }

        .btn-action {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 18px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 700;
            font-size: 0.8rem;
            transition: 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
            white-space: nowrap;
        }

        .btn-secondary {
            background: transparent;
            color: var(--text-main);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            border-color: var(--primary);
            background: var(--primary-glow);
        }

        .btn-clear {
            background: transparent;
            color: #94a3b8;
            border: none;
            padding: 10px;
        }

        .btn-clear:hover {
            color: #ef4444;
        }

        .btn-remove {
            size: 0.5rem;
            background: none;
            border: none;
            color: #ef4444;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .btn-remove:hover {
            color: #ff9494;
        }

        .result-panel {
            background: #0f172a;
        }

        .stat-main {
            background: linear-gradient(135deg, #312e81 0%, #1e1b4b 100%);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            overflow: hidden;
        }

        .stat-val-hero {
            font-size: 2.2rem;
            font-weight: 800;
            margin: 8px 0;
            color: white;
            white-space: nowrap;
        }

        .currency-pill {
            display: flex;
            justify-content: space-between;
            padding: 14px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .pill-label {
            font-size: 0.85rem;
            color: var(--text-dim);
        }

        .pill-value {
            font-weight: 700;
            color: var(--text-main);
            white-space: nowrap;
        }

        .dist-container {
            margin-top: 20px;
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 15px;
            border: 1px solid var(--border);
            flex-grow: 1;
        }

        .warning {
            color: #fbbf24;
            font-size: 0.75rem;
            background: rgba(251, 191, 36, 0.1);
            padding: 8px;
            border-radius: 8px;
            margin-top: 10px;
            display: none;
        }

        .instructions-container {
            grid-column: span 2;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 1100px) {
            .instructions-container {
                grid-template-columns: 1fr;
                grid-column: span 1;
            }
        }

        .info-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--border);
            padding: 25px;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
        }

        .info-card h3 {
            font-size: 0.9rem;
            color: var(--primary);
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .info-card p {
            font-size: 0.85rem;
            color: var(--text-dim);
            line-height: 1.6;
        }

        .info-card ul {
            padding-left: 18px;
            margin-top: 12px;
        }

        .info-card li {
            font-size: 0.85rem;
            color: var(--text-dim);
            margin-bottom: 6px;
        }

        #loadBtn {
            display: none;
        }
    </style>
</head>

<body>

    <div class="wrapper">
        <div class="panel">
            <div class="header-flex">
                <h1>WealthFlow Calculator</h1>
                <div class="header-actions">
                    <button class="btn-action btn-clear" onclick="resetAll()">Clear</button>
                    <button id="loadBtn" class="btn-action btn-secondary" onclick="loadSaved()">Load Saved</button>
                    <button class="btn-action" onclick="saveData()">Save Scenario</button>
                </div>
            </div>

            <div class="input-grid">
                <div class="field"><label>Current Savings</label><input type="number" id="savings" placeholder="0">
                </div>
                <div class="field"><label>Current Age</label><input type="number" id="age" value="25"></div>
                <div class="field"><label>Monthly Salary</label><input type="number" id="salary" placeholder="0"
                        oninput="syncInvestValue()"></div>
                <div class="field"><label>Retire Age</label><input type="number" id="retireAge" value="60"></div>
                <div class="field"><label>Invest %</label><input type="number" id="investPerc" value="20"
                        oninput="syncInvestValue()"></div>
                <div class="field"><label>Invest Value</label><input type="number" id="investVal" placeholder="0"
                        oninput="syncInvestPerc()"></div>
                <div class="field"><label>Salary Raise %</label><input type="number" id="raise" value="10"></div>
            </div>

            <div class="section-title">
                INVESTMENT PORTFOLIO SPLIT
                <button class="btn-add" onclick="addInvestmentRow('', '', '')">+ Add Asset/Fund</button>
            </div>
            <div id="investmentsContainer"></div>
            <div id="weightWarning" class="warning">⚠️ Total Split should equal 100% for better results.</div>

            <div class="section-title">CONVERSION RATES</div>
            <div class="input-grid">
                <div class="field"><label>Gold Rate</label><input type="number" id="gold" value="280000"></div>
                <div class="field"><label>USD Rate</label><input type="number" id="usd" value="278"></div>
            </div>
        </div>

        <div class="panel result-panel">
            <h1>Projections</h1>

            <div class="stat-main">
                <div class="pill-label" style="color: #a5b4fc;">Total Projected Wealth</div>
                <div class="stat-val-hero" id="resTotal">Rs. 0</div>
                <div style="font-size: 0.85rem; color: var(--accent); font-weight: 700;" id="resGrowth">+0% Growth</div>
            </div>

            <div class="currency-pill"><span class="pill-label">USD Equivalent</span><span class="pill-value"
                    id="resUSD">$0</span></div>
            <div class="currency-pill"><span class="pill-label">Gold Equivalent</span><span class="pill-value"
                    id="resGold">0.00</span></div>
            <div class="currency-pill"><span class="pill-label">Salary at Retirement</span><span class="pill-value"
                    id="resFinalSalary">Rs. 0</span></div>
            <div class="currency-pill"><span class="pill-label">Avg. Weighted Return</span><span class="pill-value"
                    id="resReturn">0%</span></div>
            <div class="currency-pill"><span class="pill-label">Working Horizon</span><span class="pill-value"
                    id="resYears">0 Years</span></div>

            <div class="dist-container">
                <div class="pill-label"
                    style="text-transform: uppercase; font-weight: 800; margin-bottom: 10px; color: var(--primary);">
                    Portfolio Breakdown</div>
                <div id="distList">
                    <p style="font-size: 0.8rem; color: var(--text-dim); padding-top: 10px;">Define assets to see value
                        distribution.</p>
                </div>
            </div>
        </div>

        <div class="instructions-container">
            <div class="info-card">
                <h3>How it works</h3>
                <p>WealthFlow calculates your financial future by compounding growth across your career timeline.</p>
                <ul>
                    <li><strong>Invest Split:</strong> Determine how much of your monthly income is saved (either by %
                        or flat value).</li>
                    <li><strong>Asset Portfolio:</strong> If funds are added, growth is calculated using a weighted
                        return based on your split.</li>
                    <li><strong>Calculations:</strong> Includes annual salary compounding and monthly reinvestment
                        compounding.</li>
                </ul>
            </div>
            <div class="info-card">
                <h3>Data Management</h3>
                <p>Manage your simulations effectively:</p>
                <ul>
                    <li><strong>Save Scenario:</strong> Stores your current inputs locally in your browser.</li>
                    <li><strong>Load Saved:</strong> Recalls your last saved setup. Only visible if data exists.</li>
                    <li><strong>Clear:</strong> Resets current fields to default state without deleting your saved
                        scenario.</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        const saveKey = 'wealth_calc_user_save';

        function syncInvestValue() {
            const salary = parseFloat(document.getElementById('salary').value) || 0;
            const perc = parseFloat(document.getElementById('investPerc').value) || 0;
            const finalPerc = Math.min(perc, 100);
            if (perc > 100) document.getElementById('investPerc').value = 100;
            document.getElementById('investVal').value = Math.round(salary * (finalPerc / 100));
            calculate();
        }

        function syncInvestPerc() {
            const salary = parseFloat(document.getElementById('salary').value) || 0;
            const val = parseFloat(document.getElementById('investVal').value) || 0;
            if (salary > 0) {
                const finalVal = Math.min(val, salary);
                if (val > salary) document.getElementById('investVal').value = salary;
                document.getElementById('investPerc').value = ((finalVal / salary) * 100).toFixed(1);
            }
            calculate();
        }

        function addInvestmentRow(name = '', split = '', ret = '') {
            const id = Date.now();
            const container = document.getElementById('investmentsContainer');
            const row = document.createElement('div');
            row.className = 'invest-row';
            row.id = `row-${id}`;
            row.innerHTML = `
                <div class="field"><input type="text" value="${name}" placeholder="Fund/Asset Name" class="title-input"></div>
                <div class="field"><input type="number" class="weight-input" value="${split}" placeholder="% Split"></div>
                <div class="field"><input type="number" class="return-input" value="${ret}" placeholder="% Return"></div>
                <button class="btn-remove" onclick="removeRow(${id})">&times;</button>
            `;
            container.appendChild(row);
            attachListeners();
            calculate();
        }

        function removeRow(id) {
            const row = document.getElementById(`row-${id}`);
            if (row) row.remove();
            calculate();
        }

        function attachListeners() {
            document.querySelectorAll('input').forEach(input => {
                input.removeEventListener('input', calculate);
                input.addEventListener('input', calculate);
            });
        }

        function calculate() {
            const savings = parseFloat(document.getElementById('savings').value) || 0;
            const salary = parseFloat(document.getElementById('salary').value) || 0;
            const age = parseInt(document.getElementById('age').value) || 0;
            const retireAge = parseInt(document.getElementById('retireAge').value) || 0;
            const investPerc = (parseFloat(document.getElementById('investPerc').value) || 0) / 100;
            const raise = (parseFloat(document.getElementById('raise').value) || 0) / 100;
            const gold = parseFloat(document.getElementById('gold').value) || 1;
            const usd = parseFloat(document.getElementById('usd').value) || 1;

            let totalWeight = 0;
            let weightedReturn = 0;
            const assets = [];
            const investRows = document.querySelectorAll('.invest-row');

            investRows.forEach(row => {
                const n = row.querySelector('.title-input').value || "Unnamed Asset";
                const w = parseFloat(row.querySelector('.weight-input').value) || 0;
                const r = parseFloat(row.querySelector('.return-input').value) || 0;
                totalWeight += w;
                weightedReturn += (w / 100) * (r / 100);
                assets.push({ name: n, weight: w / 100 });
            });

            document.getElementById('weightWarning').style.display = (investRows.length > 0 && totalWeight !== 100) ? 'block' : 'none';

            const years = retireAge - age;
            if (years <= 0) {
                document.getElementById('resTotal').innerText = "Check Age";
                return;
            }

            let wealth = savings;
            let curSalary = salary;
            const monthlyRet = Math.pow(1 + weightedReturn, 1 / 12) - 1;

            for (let y = 0; y < years; y++) {
                for (let m = 0; m < 12; m++) {
                    wealth = (wealth + (curSalary * investPerc)) * (1 + monthlyRet);
                }
                curSalary *= (1 + raise);
            }

            // Projections UI
            document.getElementById('resTotal').innerText = `Rs. ${Math.round(wealth).toLocaleString()}`;
            document.getElementById('resUSD').innerText = `$${(wealth / usd).toLocaleString(undefined, { maximumFractionDigits: 0 })}`;
            document.getElementById('resGold').innerText = (wealth / gold).toFixed(2);
            document.getElementById('resFinalSalary').innerText = `Rs. ${Math.round(curSalary).toLocaleString()}`;
            document.getElementById('resReturn').innerText = `${(weightedReturn * 100).toFixed(1)}%`;
            document.getElementById('resYears').innerText = `${years} Yrs`;

            const growth = savings > 0 ? ((wealth - savings) / savings * 100).toFixed(0) : 0;
            document.getElementById('resGrowth').innerText = `+${growth}% TOTAL GROWTH`;

            // Distribution Breakdown logic
            const distList = document.getElementById('distList');
            if (investRows.length > 0) {
                distList.innerHTML = '';
                assets.forEach(asset => {
                    const assetVal = wealth * asset.weight;
                    const row = document.createElement('div');
                    row.className = 'currency-pill';
                    row.style.padding = '8px 0';
                    row.style.fontSize = '0.8rem';
                    row.innerHTML = `<span class="pill-label">${asset.name} - ${asset.weight * 100}%</span><span class="pill-value">Rs. ${Math.round(assetVal).toLocaleString()}</span>`;
                    distList.appendChild(row);
                });

                // "Cash/Unallocated" if split < 100%
                if (totalWeight < 100) {
                    const cashWeight = (100 - totalWeight) / 100;
                    const cashVal = wealth * cashWeight;
                    const row = document.createElement('div');
                    row.className = 'currency-pill';
                    row.style.padding = '8px 0';
                    row.style.fontSize = '0.8rem';
                    row.style.opacity = '0.7';
                    row.innerHTML = `<span class="pill-label">Cash - ${cashWeight * 100}%</span><span class="pill-value">Rs. ${Math.round(cashVal).toLocaleString()}</span>`;
                    distList.appendChild(row);
                }
            } else {
                distList.innerHTML = '<p style="font-size: 0.8rem; color: var(--text-dim); padding-top: 10px;">Define assets to see value distribution.</p>';
            }
        }

        function saveData() {
            const data = {
                savings: document.getElementById('savings').value,
                salary: document.getElementById('salary').value,
                age: document.getElementById('age').value,
                retireAge: document.getElementById('retireAge').value,
                investPerc: document.getElementById('investPerc').value,
                investVal: document.getElementById('investVal').value,
                raise: document.getElementById('raise').value,
                gold: document.getElementById('gold').value,
                usd: document.getElementById('usd').value,
                investments: []
            };
            document.querySelectorAll('.invest-row').forEach(row => {
                data.investments.push({
                    t: row.querySelector('.title-input').value,
                    w: row.querySelector('.weight-input').value,
                    r: row.querySelector('.return-input').value
                });
            });
            localStorage.setItem(saveKey, JSON.stringify(data));
            checkSavedStatus();
            alert('Scenario successfully saved.');
        }

        function loadSaved() {
            const saved = localStorage.getItem(saveKey);
            if (!saved) return;
            const data = JSON.parse(saved);
            document.getElementById('savings').value = data.savings;
            document.getElementById('age').value = data.age;
            document.getElementById('salary').value = data.salary;
            document.getElementById('retireAge').value = data.retireAge;
            document.getElementById('investPerc').value = data.investPerc;
            document.getElementById('investVal').value = data.investVal || 0;
            document.getElementById('raise').value = data.raise;
            document.getElementById('gold').value = data.gold;
            document.getElementById('usd').value = data.usd;
            document.getElementById('investmentsContainer').innerHTML = '';
            data.investments.forEach(inv => addInvestmentRow(inv.t, inv.w, inv.r));
            calculate();
        }

        function checkSavedStatus() {
            const saved = localStorage.getItem(saveKey);
            document.getElementById('loadBtn').style.display = saved ? 'inline-block' : 'none';
        }

        function resetAll() {
            if (confirm("Reset current inputs to default?")) {
                location.reload();
            }
        }

        window.onload = () => {
            checkSavedStatus();
            attachListeners();
            calculate();
        };
    </script>
</body>

</html>
